def _extract_gstin(self) -> str:
    with pdfplumber.open(self.pdf_path) as pdf:
        first_page_text = pdf.pages[0].extract_text()

    match = re.search(r"\b\d{2}[A-Z]{5}\d{4}[A-Z]\d[A-Z]\w\b", first_page_text)
    if not match:
        raise ValueError("GSTIN not found on first page")

    return match.group(0)



gstin = self._extract_gstin()

result["GSTIN"] = gstin

return {
    "gstin": gstin,
    "itc_values": result
}






import os

def process_folder(folder_path):
    results = []

    for file in os.listdir(folder_path):
        if file.lower().endswith(".pdf"):
            pdf_path = os.path.join(folder_path, file)
            print(f"Processing: {file}")

            try:
                parser = GSTPaymentParser(pdf_path)
                data = parser.parse()
                data["file_name"] = file
                results.append(data)
            except Exception as e:
                print(f"Error in {file}: {e}")

    return results






if __name__ == "__main__":
    folder = r"C:\Users\YourPath\GST NEFT"

    all_results = process_folder(folder)

    print("\nFinal Output:\n")

    for record in all_results:
        print("-" * 50)
        for k, v in record.items():
            if isinstance(v, Decimal):
                print(f"{k}: {format(v, 'f')}")
            else:
                print(f"{k}: {v}")








